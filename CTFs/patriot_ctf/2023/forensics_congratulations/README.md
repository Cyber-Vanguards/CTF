# Congratulations, (forensics)

## Introduction

> Congratulations on making it this far, here's an email attachment.

## Solution

The downloaded file is a Word document.

Use **`olevba --reveal Congratulations.docm`** which helps extract any macros in the Word document.

```
XLMMacroDeobfuscator: pywin32 is not installed (only is required if you want to use MS Excel)olevba 0.60.1 on Python 3.11.4 - http://decalage.info/python/oletools===============================================================================FILE: Congratulations.docmType: OpenXMLWARNING  For now, VBA stomping cannot be detected for files in memory-------------------------------------------------------------------------------VBA MACRO ThisDocument.cls in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - (empty macro)-------------------------------------------------------------------------------VBA MACRO NewMacros.bas in file: word/vbaProject.bin - OLE stream: 'VBA/NewMacros'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Dim x51 As String    Dim x49 As String    x51 = "C:\Program Files\Internet Explorer\iexplore.exe"    Dim x50 As Integer    Dim x47 As Double    For x50 = 1 To 100        x47 = Sqr(x50) * 2 + 5 / x50    Next x50    MsgBox "cYvSGF9cFrrEmfYFW8Yo", vbInformation, "aThg"    x49 = [char]0x50 + [char]0x43 + [char]0x54 + [char]0x46 + [char]0x7B + [char]0x33 + [char]0x6E + [char]0x34 + [char]0x62 + [char]0x6C + [char]0x33 + [char]0x5F + [char]0x6D + [char]0x34 + [char]0x63 + [char]0x72 + [char]0x30 + [char]0x35 + [char]0x5F + [char]0x70 + [char]0x6C + [char]0x7A + [char]0x5F + [char]0x32 + [char]0x37 + [char]0x33 + [char]0x31 + [char]0x35 + [char]0x36 + [char]0x37 + [char]0x30 + [char]0x7D    Shell x51 & " " & x49, vbNormalFocus    Application.Wait Now + TimeValue("00:00:02")    MsgBox "sgTdrn8Np2Kpfnmr9y57" & x49, vbInformation, "foSds"    Dim x45(1 To 10) As Integer    Dim x46 As Integer    For x50 = 1 To 10        x46 = Int((100 - 1 + 1) * Rnd + 1)        x45(x50) = x46    Next x50    Dim x52 As Integer    Dim x53 As Integer    For x50 = 1 To 9        For x53 = x50 + 1 To 10            If x45(x50) > x45(x53) Then                x52 = x45(x50)                x45(x50) = x45(x53)                x45(x53) = x52            End If        Next x53    Next x50    Dim x54 As String    For x50 = 1 To 10        x54 = x54 & x45(x50) & ", "    Next x50    MsgBox "phNuYUNwdHHCJdVL4hJd" & Left(x54, Len(x54) - 2), vbInformation, "LOEC"    Dim x55 As Worksheet    Set x55 = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))    x55.Name = "TtrZ4"    Dim x56 As ChartObject    Set x56 = x55.ChartObjects.Add(Left:=10, Top:=10, Width:=300, Height:=200)    Dim x57 As Range    Set x57 = x55.Range("A1:B5")    x57.Value = Application.WorksheetFunction.RandBetween(1, 100)    x56.Chart.SetSourceData Source:=x57    x56.Chart.ChartType = xlColumnClustered    Exit SubErrorHandler:    MsgBox "hWgjD9NKf7UqXdAq0GBb", vbCritical, "uv9b"End Sub+----------+--------------------+---------------------------------------------+|Type      |Keyword             |Description                                  |+----------+--------------------+---------------------------------------------+|Suspicious|Shell               |May run an executable file or a system       ||          |                    |command                                      ||Suspicious|vbNormalFocus       |May run an executable file or a system       ||          |                    |command                                      ||Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be ||          |                    |used to obfuscate strings (option --decode to||          |                    |see all)                                     ||IOC       |iexplore.exe        |Executable file name                         ||Base64    |i8`                 |aThg                                         ||String    |                    |                                             |+----------+--------------------+---------------------------------------------+MACRO SOURCE CODE WITH DEOBFUSCATED VBA STRINGS (EXPERIMENTAL):Attribute VB_Name = "NewMacros"Dim x51 As String    Dim x49 As String    x51 = "C:\Program Files\Internet Explorer\iexplore.exe"    Dim x50 As Integer    Dim x47 As Double    For x50 = 1 To 100        x47 = Sqr(x50) * 2 + 5 / x50    Next x50    MsgBox "cYvSGF9cFrrEmfYFW8Yo", vbInformation, "aThg"    x49 = [char]0x50 + [char]0x43 + [char]0x54 + [char]0x46 + [char]0x7B + [char]0x33 + [char]0x6E + [char]0x34 + [char]0x62 + [char]0x6C + [char]0x33 + [char]0x5F + [char]0x6D + [char]0x34 + [char]0x63 + [char]0x72 + [char]0x30 + [char]0x35 + [char]0x5F + [char]0x70 + [char]0x6C + [char]0x7A + [char]0x5F + [char]0x32 + [char]0x37 + [char]0x33 + [char]0x31 + [char]0x35 + [char]0x36 + [char]0x37 + [char]0x30 + [char]0x7D    Shell x51 & " " & x49, vbNormalFocus    Application.Wait Now + TimeValue("00:00:02")    MsgBox "sgTdrn8Np2Kpfnmr9y57" & x49, vbInformation, "foSds"    Dim x45(1 To 10) As Integer    Dim x46 As Integer    For x50 = 1 To 10        x46 = Int((100 - 1 + 1) * Rnd + 1)        x45(x50) = x46    Next x50    Dim x52 As Integer    Dim x53 As Integer    For x50 = 1 To 9        For x53 = x50 + 1 To 10            If x45(x50) > x45(x53) Then                x52 = x45(x50)                x45(x50) = x45(x53)                x45(x53) = x52            End If        Next x53    Next x50    Dim x54 As String    For x50 = 1 To 10        x54 = x54 & x45(x50) & ", "    Next x50    MsgBox "phNuYUNwdHHCJdVL4hJd" & Left(x54, Len(x54) - 2), vbInformation, "LOEC"    Dim x55 As Worksheet    Set x55 = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))    x55.Name = "TtrZ4"    Dim x56 As ChartObject    Set x56 = x55.ChartObjects.Add(Left:=10, Top:=10, Width:=300, Height:=200)    Dim x57 As Range    Set x57 = x55.Range("A1:B5")    x57.Value = Application.WorksheetFunction.RandBetween(1, 100)    x56.Chart.SetSourceData Source:=x57    x56.Chart.ChartType = xlColumnClustered    Exit SubErrorHandler:    MsgBox "hWgjD9NKf7UqXdAq0GBb", vbCritical, "uv9b"End Sub
```

This section looked promising: **`[char]0x50 + [char]0x43 + [char]0x54 + [char]0x46 + [char]0x7B + [char]0x33 + [char]0x6E + [char]0x34 + [char]0x62 + [char]0x6C + [char]0x33 + [char]0x5F + [char]0x6D + [char]0x34 + [char]0x63 + [char]0x72 + [char]0x30 + [char]0x35 + [char]0x5F + [char]0x70 + [char]0x6C + [char]0x7A + [char]0x5F + [char]0x32 + [char]0x37 + [char]0x33 + [char]0x31 + [char]0x35 + [char]0x36 + [char]0x37 + [char]0x30 + [char]0x7D`**

Reformat so we can decode **`50 43 54 46 7B 33 6E 34 62 6C 33 5F 6D 34 63 72 30 35 5F 70 6C 7A 5F 32 37 33 31 35 36 37 30 7D`**

Use [RapidTables](https://www.rapidtables.com/convert/number/ascii-hex-bin-dec-converter.html) to convert the hex for the flag. 

## Flag

**`PCTF{3n4bl3_m4cr05_plz_27315670}`**

## Tools

- **`olevba`**
- [RapidTables](https://www.rapidtables.com/convert/number/ascii-hex-bin-dec-converter.html)

